{% extends 'blog/base.html' %}

{% block title %}
{{ post.title }}
{% endblock title %}

{% block content%}

<h1>{{ post.title }}</h1>
<p class="tags">
    Tags:
    {% for tag in post.tags.all %}
    <a href="{% url 'blog:post_list_by_tag' tag.slug %}">
        {{ tag.name }}
    </a>
    {% if not forloop.last %}, {% endif %}
    {% endfor %}
</p>
<p class="date">
    Published {{ post.publish }} by {{ post.author }}
    {{ post.body|linebreaks}}
    <a href="{% url 'blog:post_share' post.id %}">
        Share this post
    </a>
</p>
<h2>
    {% with comments.count as total_comments %}
    {{ total_comments }} comment{{ total_comments|pluralize }} so far
    {% endwith %}
</h2>
{% for comment in comments %}
    <div class="comment">
        <p class="info">
            Comment {{ forloop.counter }} by {{ comment.name }}
            {{ comment.created }}
        </p>
        {{ comment.body }}
    </div>
{% empty %}
    <p> There are no comments yet. </p>
{% endfor %}

{% if not new_comment %}
    <h2> Add a new comment </h2>
    <form method="POST">
        {{ comment_form.as_p }}
        {% csrf_token %}
        <input type="submit" value="" class="comment_button">
    </form>
{% endif %}
{% if new_comment %}
        <h2> Comment added successfully </h2>
{% endif %}

<h2 class="bottom">Check out some similar posts:</h2>
{% for post in similar_posts %}
    <a href="{{ post.get_absolute_url }}" class="bottom">
        <h3 class="bottom"> - {{ post.title }} </h3>
        <p class="date bottom">
            Published {{ post.publish }} by {{ post.author }}
        </p>
    </a>
{% empty %}
    <p class="bottom">There are no similar posts so far...</p>
{% endfor%}

{% endblock content %}